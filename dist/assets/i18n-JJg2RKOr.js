const t="selectedLanguage",e=new Set(["en","ar","pl","tr"]),n="en";const a=new class{constructor(){this.translations={},this.baseTexts={},this.currentLang=this.getStoredLanguage(),this.defaultTitle=document.title,this.defaultSlogan=this.getDefaultSlogan(),this.isLoading=!1}getStoredLanguage(){const a=localStorage.getItem(t);return e.has(a)?a:n}getDefaultSlogan(){const t=document.getElementById("motto");return t?t.textContent:""}async loadTranslations(t){if(t===n)return this.translations={},void this.updatePage();const e=Date.now(),a=this.getTranslationPaths(t,e);for(const n of a)try{const t=await fetch(n,{cache:"no-store",headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0",Accept:"application/json"},signal:AbortSignal.timeout(5e3)});if(t.ok)return this.translations=await t.json(),void this.updatePage()}catch(s){s.name;continue}this.translations={},this.updatePage()}getTranslationPaths(t,e){const n=[`lang/${t}.json?v=${e}`,`/lang/${t}.json?v=${e}`];return window.location.pathname.includes("/services/")&&n.unshift(`../lang/${t}.json?v=${e}`),n.push(new URL(`lang/${t}.json`,location.href).href+`?v=${e}`),n}updatePage(){const t=this.currentLang===n;document.querySelectorAll("[data-key]").forEach(e=>{const n=e.getAttribute("data-key");n in this.baseTexts||(this.baseTexts[n]=e.textContent);const a=this.translations[n],s=this.baseTexts[n],i=t?s:void 0!==a?a:s;void 0!==i&&("A"===e.tagName?e.textContent=String(i).split(":")[0].trim():e.textContent=i)}),t?document.title=this.defaultTitle:this.translations.title&&(document.title=this.translations.title);const e=document.getElementById("motto");e&&(e.textContent=t?this.defaultSlogan:this.translations.slogan||this.defaultSlogan),this.updateDirection(),document.documentElement.setAttribute("lang",this.currentLang)}updateDirection(){const t=document.documentElement;"ar"===this.currentLang?t.setAttribute("dir","rtl"):t.setAttribute("dir","ltr")}async changeLanguage(n){if(e.has(n)&&!this.isLoading)if(this.currentLang!==n){this.isLoading=!0,this.currentLang=n,localStorage.setItem(t,n);try{await this.loadTranslations(n),this.updateLanguageToggle(n),this.closeLanguageMenu(),window.dispatchEvent(new CustomEvent("languagechange",{detail:{lang:n}}))}catch(a){}finally{this.isLoading=!1}}else this.closeLanguageMenu()}closeLanguageMenu(){const t=document.getElementById("language-menu");t&&(t.classList.remove("is-open"),t.setAttribute("aria-hidden","true"));const e=document.getElementById("language-toggle");e&&e.setAttribute("aria-expanded","false")}updateLanguageToggle(t){const e=document.getElementById("language-toggle");if(!e)return;const n=this.getFlagUrl(t),a=this.getLanguageName(t);e.textContent="";const s=document.createElement("img");s.src=n,s.alt=t,s.className="language-toggle__flag",e.appendChild(s),e.appendChild(document.createTextNode(" "+a))}getFlagUrl(t){const e={en:"https://flagcdn.com/w20/gb.png",ar:"https://flagcdn.com/w20/eg.png",pl:"https://flagcdn.com/w20/pl.png",tr:"https://flagcdn.com/w20/tr.png"};return e[t]||e[n]}getLanguageName(t){return{en:"English",ar:"العربية",pl:"Polski",tr:"Türkçe"}[t]||"English"}async init(){await this.loadTranslations(this.currentLang),this.updateLanguageToggle(this.currentLang)}};window.changeLanguage=t=>{window._langChangeTimeout&&clearTimeout(window._langChangeTimeout),window._langChangeTimeout=setTimeout(()=>{a.changeLanguage(t)},100)},window.toggleLanguageMenu=()=>{const t=document.getElementById("language-menu"),e=document.getElementById("language-toggle");if(!t||!e)return;const n=t.classList.contains("is-open");t.classList.toggle("is-open"),e.setAttribute("aria-expanded",String(!n)),t.setAttribute("aria-hidden",String(n))},document.addEventListener("click",t=>{const e=document.getElementById("language-menu"),n=document.getElementById("languageGroup");if(e&&n&&!n.contains(t.target)){e.classList.remove("is-open");const t=document.getElementById("language-toggle");t&&(t.setAttribute("aria-expanded","false"),e.setAttribute("aria-hidden","true"))}},{passive:!0});export{a as i};
